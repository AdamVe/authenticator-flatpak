app-id: com.yubico.yubioath
runtime: org.gnome.Platform
runtime-version: '45'
sdk: org.gnome.Sdk
command: authenticator
finish-args:
  - --socket=x11
  - --socket=pcsc
  - --device=all  # needed for FIDO
modules:
  - name: pcsc-lite
    config-opts:
      - --disable-libudev
      - --disable-libsystemd
      - --without-systemdsystemunitdir
      - --disable-serial
      - --disable-usb
      - --disable-documentation
      - --disable-polkit
    cleanup:
      - '/include'
      - '/bin/pcsc-spy'
      - '/lib/libpcscspy*'
      - '/lib/pkg-config'
      - '/share/doc'
      - '/share/man'
    post-install:
      - rm /app/sbin/pcscd
      - rmdir /app/sbin || true
    sources:
      - type: archive
        url: https://pcsclite.apdu.fr/files/pcsc-lite-2.2.1.tar.xz
        sha256: 625edcd6cf4b45af015eb5b6b75ea47f8914e892774c67e1079c9553c8665a57
  - name: yubico_authenticator
    buildsystem: simple
    build-commands:
      - install -D authenticator /app/bin/authenticator
      - cp -R data helper lib /app/bin/
    sources:
      - type: archive
        url: https://developers.yubico.com/yubioath-flutter/Releases/yubico-authenticator-7.0.0-linux.tar.gz
        sha256: ec6bdca21ffabb0565d0d63f3e5525953dbb98b7ac2263bacea3770a18555ee5
